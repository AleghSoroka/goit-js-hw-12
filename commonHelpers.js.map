{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport { hitsPerPage } from \"../main\";\n\nexport async function getImages(userRequest, currentPage) {\n    const BASE_URL = 'https://pixabay.com';\n    const END_POINT = '/api/';\n\n    const params = {\n        key: '43216617-d9e2d51a1f64026c97bc97c8e',\n        q: `${userRequest}`,\n        page: currentPage,\n        per_page: hitsPerPage,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n    };\n    \n    const url = `${BASE_URL}${END_POINT}`;\n    \n    const res = await axios.get(url, { params });\n    console.log(\"totalHits: \", res.data.totalHits);\n      return res.data\n};\n ","\nexport function imagesRender(array) { \n    return array.map(({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n    }) => {\n        return `<li class = \"gallery-item\">\n\n  <a class = \"gallery-link\" href=\"${largeImageURL}\">\n    <img\n    loading=\"lazy\"\n    src = \"${webformatURL}\" \n    alt=\"${tags}\"\n    class=\"gallery-image\"\n    />\n  </a>\n\n  <ul class = \"info-list\">\n\n    <li class=\"info-container\">\n      <h2 class=\"main-info\">Likes </h2>\n      <p class=\"info\">${likes}</p>\n    </li>\n\n    <li class=\"info-container\">\n      <h2 class=\"main-info\"> Views </h2>\n      <p class=\"info\">${views}</p>\n    </li>\n\n    <li class=\"info-container\">\n      <h2 class=\"main-info\">Comments </h2>\n      <p class=\"info\">${comments}</p>\n    </li>\n\n    <li class=\"info-container\">\n      <h2 class=\"main-info\">Downloads </h2>\n      <p class=\"info\">${downloads}</p>\n    </li>\n\n  </ul>\n\n</li>`}\n     \n\n    ).join('')\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImages } from './js/pixabay-api';\nimport { imagesRender } from './js/render-functions';\n\nconst lightbox = new SimpleLightbox('.gallery-link',\n  {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\nexport const hitsPerPage = 15;\nlet userRequestStr;\nlet currentPage = 1;\nlet totalPages = 0;\n\nconst userRequestForm = document.querySelector('.user_request_form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.load_more');\n\nuserRequestForm.addEventListener('submit', onRequestSubmit);\nloadMore.addEventListener('click', onLoadMoreClick);\n\nasync function onRequestSubmit(event) {\n  event.preventDefault();\n  currentPage = 1;\n  showLoader();\n  userRequestStr = event.target.elements.user_query.value\n    .toLowerCase()\n    .trim()\n    .replaceAll('  ', ' ')\n    .replaceAll(' ', '+')\n    .replaceAll('++', '+');\n\n  if (!userRequestStr) {\n    iziToast.error({\n      backgroundColor: 'red',\n      icon: false,\n      progressBar: false,\n      close: false,\n      position: 'topRight',\n      message: 'Please, input a valid request!',\n    });\n    hideLoader();\n    return;\n  } else {\n    try {\n      const data = await getImages(userRequestStr, currentPage);\n      totalPages = Math.ceil(data.totalHits / hitsPerPage);\n      if (totalPages) {\n        gallery.innerHTML = imagesRender(data.hits);\n        loadMoreBtnVisibility();\n      }\n      else {\n        hideLoader();\n        loadMoreBtnVisibility();\n        gallery.innerHTML = '';\n        iziToast.error({\n          backgroundColor: 'red',\n          icon: false,\n          progressBar: false,\n          close: false,\n          position: 'topRight',\n          message: 'There are no images matching Your request!',\n        });\n      }\n    } catch (error) {\n      hideLoader();\n      gallery.innerHTML = '';\n      iziToast.error({\n        backgroundColor: 'red',\n        icon: false,\n        progressBar: false,\n        close: false,\n        position: 'topRight',\n        message:\n          'Something went wrong during your request. Please, try again later!',\n      });\n    }\n    \n    hideLoader();\n  }\n\n  lightbox.refresh();\n  event.target.reset();\n}\n\n\n\nfunction showLoader() {\n  loader.classList.remove('is-hidden');\n}\n\nfunction hideLoader() {\n  loader.classList.add('is-hidden');\n}\n\nfunction loadMoreBtnVisibility() {\n  if (currentPage < totalPages) {\n    loadMore.classList.remove('is-hidden');\n  } else {\n    loadMore.classList.add('is-hidden');\n  }\n}\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n  const data = await getImages(userRequestStr, currentPage);\n  const markup = imagesRender(data.hits);\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  const galleryItemHeight = gallery.firstElementChild.getBoundingClientRect().height;\n  window.scrollBy({ top: galleryItemHeight * 2, behavior: 'smooth' });\n\n  if (currentPage >= totalPages) { \n    iziToast.error({\n        backgroundColor: 'white',\n        icon: false,\n        progressBar: false,\n        close: false,\n        position: 'center',\n        message:\n          \"We're sorry, but you've reached the end of search results.\",\n      });\n  }\n  loadMoreBtnVisibility();\n  lightbox.refresh();\n}\n"],"names":["getImages","userRequest","currentPage","BASE_URL","END_POINT","params","hitsPerPage","url","res","axios","imagesRender","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","userRequestStr","totalPages","userRequestForm","gallery","loader","loadMore","onRequestSubmit","onLoadMoreClick","event","showLoader","data","loadMoreBtnVisibility","hideLoader","iziToast","markup","galleryItemHeight"],"mappings":"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"}